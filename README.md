# RenormalizationSim.jl

このプロジェクトは、スカラー場の量子論（$\lambda\phi^4$理論）における**1ループ繰り込み**の概念を視覚的に実証するためのJuliaシミュレーションです。

物理的に観測される質量と相互作用の強さを一定に保つために、理論のカットオフスケール $\Lambda$ に応じて、「裸のパラメータ（裸の質量 $m_0$ と波動関数の繰り込み定数 $Z$）」がどのように変化するか（繰り込みフロー）を計算し、プロットします。

##  主要な概念

* **繰り込み (Renormalization)**: 理論計算で現れる発散を、カットオフに依存する「裸のパラメータ」を導入することで吸収し、有限な物理的観測量と結びつける一連の手法。
* **自己エネルギー (Self-Energy, $\Sigma(p^2)$)**: 相互作用によって粒子が自身と仮想的に相互作用する効果。伝播関数を補正する。
* **裸の質量と物理質量 (Bare vs. Physical Mass)**: 理論のラグランジアンに現れる基本パラメータ（$m_0$）と、実験で観測される実際の質量（$m_{\text{phys}}$）の関係。
* **波動関数の繰り込み (Field Strength Renormalization, $Z$)**: 相互作用によって、場のオペレータそのものの規格化が変化する効果を補正する定数。
* **繰り込みフロー (Renormalization Flow)**: エネルギー・スケール（カットオフ $\Lambda$）の変化に伴い、理論のパラメータ ($m_0^2, Z$) がどのように変化していくかの「流れ」。
* **伝播関数 (Propagator)**: ある時空点から別の点への粒子の伝播振幅を表す関数。

---

##  理論的背景

### 着衣した伝播関数

相互作用を考慮した「着衣した（Dressed）」伝播関数 $D'(p^2)$ は、自由な伝播関数を自己エネルギー $\Sigma(p^2)$ で補正した形で与えられます。

$$
D'(p^2) = \frac{i Z}{p^2 - m_{\text{phys}}^2 + i\epsilon}
$$

これは、裸のパラメータを用いた以下の表現と等価です。

$$
D'(p^2) = \frac{i}{p^2 - m_0^2 - \Sigma(p^2) + i\epsilon}
$$

### オンシェル繰り込み条件

裸のパラメータを物理量に結びつけるため、以下のオンシェル条件を課します。

1.  **質量の繰り込み**: 伝播関数の極が物理質量の2乗 $p^2 = m_{\text{phys}}^2$ に一致するように裸の質量 $m_0$ を定めます。

    $$
    m_0^2 = m_{\text{phys}}^2 - \text{Re}[\Sigma(p^2=m_{\text{phys}}^2)]
    $$

2.  **波動関数の繰り込み**: 物理質量の点における伝播関数の留数が $i$ になるように、波動関数の繰り込み定数 $Z$ を定めます。

    $$
    Z^{-1} = 1 - \frac{\partial \text{Re}[\Sigma(p^2)]}{\partial p^2} \Bigg|_{p^2=m_{\text{phys}}^2}
    $$

### 1ループ自己エネルギーの計算

このシミュレーションでは、$\lambda\phi^4$理論における1ループ自己エネルギーを、運動量カットオフ $\Lambda$ を用いて計算します。ウィック回転後のユークリッド空間での積分は以下の通りです。

$$
\Sigma(p^2_{\text{euclidean}}) = \frac{\lambda}{16\pi^2} \int_0^{\Lambda} \frac{k^3 dk}{k^2 + m_{\text{phys}}^2}
$$

この積分を数値的に計算するのが `calculate_sigma` 関数です。また、その $p^2$ に関する微分をモデル化して計算するのが `calculate_sigma_derivative` 関数です。

---

##  前提条件

このシミュレーションを実行するには、Juliaがインストールされている必要があります。また、以下のパッケージが必要です。

* `Plots` (グラフ描画用)
* `QuadGK` (高精度な数値積分用)
* `Printf` (数値の書式設定用)

JuliaのREPL（対話環境）で、以下のコマンドを実行してパッケージをインストールできます。

```julia
using Pkg
Pkg.add("Plots")
Pkg.add("QuadGK")
Pkg.add("Printf")
```


##  生成されるプロット

生成される画像には3つのグラフが含まれます。

### Graph 1: Renormalization Flow of Mass

物理質量 (`m_phys²`) を一定に保つために、運動量カットオフ `Λ` の変化に応じて自己エネルギー `Σ` と裸の質量 `m₀²` がどのように変化するかを示します。

### Graph 2: Renormalization Flow of Z-factor

カットオフ `Λ` の変化に応じて、波動関数の繰り込み定数 `Z` がどのように変化するかを示します。$Z=1$ が相互作用のない自由な理論に対応します。

### Graph 3: Dressed Propagator

運動量の2乗 `p²` に対する伝播関数の振る舞いを、以下の3つのケースで比較します。

1.  **Free Propagator (点線)**: 相互作用がない場合の伝播関数。
2.  **Dressed Propagator (Low Λ) (実線)**: 低いカットオフで計算した、相互作用を含む伝播関数。
3.  **Dressed Propagator (High Λ) (破線)**: 高いカットオフで計算した伝播関数。

---

##  コード構成

* `calculate_sigma(...)`: 1ループ自己エネルギー `Σ` を数値積分で計算します。
* `calculate_sigma_derivative(...)`: 自己エネルギーの微分 `dΣ/dp²` をモデル化して計算します。
* `run_full_simulation()`: シミュレーション全体を実行し、3つのグラフを生成して画像ファイルとして保存します。

