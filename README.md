# RenormalizationSim.jl

このプロジェクトは、単純なスカラー場の量子論（$\lambda\phi^4$理論）における**繰り込み**の概念を実証するためのJuliaシミュレーションです。運動量カットオフに依存して、観測される物理的な質量を一定に保つために「裸の質量」がどのように変化するか（繰り込みのフロー）を視覚化します。

##  主要な概念

* **繰り込み (Renormalization)**: 理論計算で現れる発散を、カットオフを導入した「裸のパラメータ」で再定義し、有限な物理的観測量と結びつける一連の手法。
* **自己エネルギー (Self-Energy)**: 相互作用によって粒子が自身と相互作用する効果。これにより、粒子の伝播の仕方が変化する。
* **裸の質量と物理質量 (Bare Mass vs. Physical Mass)**: 理論の基本パラメータ（裸の質量）と、実験で観測される実際の質量（物理質量）の関係。
* **繰り込みフロー (Renormalization Flow)**: エネルギー・スケール（カットオフ）の変化に伴い、理論のパラメータがどのように変化していくかの「流れ」。
* **伝播関数 (Propagator)**: 場の量子論において、ある時空点から別の点への粒子の伝播振幅を表す関数。

##  理論的背景

### 伝播関数と自己エネルギー

相互作用がない自由なスカラー場の伝播関数 $D(p^2)$ は以下のように書けます。

$$
D(p^2) = \frac{i}{p^2 - m_0^2 + i\epsilon}
$$

ここで、$m_0$ は「裸の質量」です。

しかし、粒子が自身と相互作用すると、その伝播の仕方は補正を受けます。この補正は**自己エネルギー** $\Sigma(p^2)$ として知られ、これを考慮に入れた「着衣した（Dressed）」伝播関数 $D'(p^2)$ は以下のようになります。

$$
D'(p^2) = \frac{i}{p^2 - m_0^2 - \Sigma(p^2) + i\epsilon}
$$

自己エネルギーは、理論の発散を吸収する重要な役割を担います。

### 質量の繰り込み

実験で観測される「物理質量」 $m_{\text{phys}}$ は、伝播関数が極（ポール）を持つ運動量として定義されます。これは、以下の**オンシェル繰り込み条件**によって裸の質量 $m_0$ と結びつきます。

$$
m_{\text{phys}}^2 = m_0^2 + \text{Re}[\Sigma(p^2=m_{\text{phys}}^2)]
$$

この式を $m_0^2$ について解くと、

$$
m_0^2 = m_{\text{phys}}^2 - \text{Re}[\Sigma(p^2=m_{\text{phys}}^2)]
$$

となり、物理質量を一定に保つためには、自己エネルギーの値に応じて裸の質量を調整する必要があることがわかります。

### 1ループ自己エネルギーの計算

$\lambda\phi^4$ 理論における1ループ自己エネルギーは、運動量 $k$ を持つ仮想粒子がループを走るファインマンダイアグラムに対応し、以下の積分で与えられます。

$$
\Sigma(p^2) = \frac{\lambda}{2} \int \frac{d^4k}{(2\pi)^4} \frac{i}{k^2 - m^2 + i\epsilon}
$$

この積分は紫外発散（$k \to \infty$ で発散）するため、そのままでは計算できません。そこで、運動量に上限（カットオフ） $\Lambda$ を設けます。コードでは、計算を容易にするためにウィック回転（$k_0 \to i k_4$）を行い、4次元ユークリッド空間で積分を実行しています。

$$
\Sigma(p^2_{\text{euclidean}}) = \frac{\lambda}{16\pi^2} \int_0^{\Lambda} \frac{k^3 dk}{k^2 + m_{\text{phys}}^2}
$$

この積分を数値的に計算するのが `calculate_sigma` 関数です。

##  前提条件

このシミュレーションを実行するには、Juliaがインストールされている必要があります。また、以下のパッケージが必要です。

* `Plots` (グラフ描画用)
* `QuadGK` (高精度な数値積分用)
* `Printf` (数値の書式設定用)

JuliaのREPL（対話環境）で、以下のコマンドを実行してパッケージをインストールできます。

```julia
using Pkg
Pkg.add("Plots")
Pkg.add("QuadGK")
Pkg.add("Printf")
```

## 📊 生成されるプロット

生成される画像には2つのグラフが含まれます。

### Graph 1: Renormalization Flow

物理質量 (`m_phys²`) を一定に保つために、運動量カットオフ `Λ` の変化に応じて自己エネルギー `Σ` と裸の質量 `m₀²` がどのように変化するか（フローするか）を示します。カットオフ `Λ` が大きくなるにつれて、自己エネルギー補正も大きくなり、それを打ち消すために裸の質量を調整する必要があることがわかります。これは、発散を裸のパラメータに押し込んでいる様子を視覚化したものです。

### Graph 2: Propagator Stability

運動量の2乗 `p²` に対する伝播関数の振る舞いを、以下の3つのケースで比較します。

1. **Free Propagator (点線)**: 相互作用がない場合の伝播関数。
2. **Dressed Propagator (Low Λ) (実線)**: 低いカットオフで計算した、相互作用を含む伝播関数。
3. **Dressed Propagator (High Λ) (破線)**: 高いカットオフで計算した伝播関数。

物理質量の位置にピークが見られ、カットオフの値によって伝播関数の形がどのように変化するかを視覚的に確認できます。

##  コード構成

* `calculate_sigma(...)`
  * スカラー場の1ループ自己エネルギー `Σ(p^2)` を、与えられたパラメータと運動量カットオフ `Λ` を用いて数値積分で計算します。
* `run_full_simulation()`
  * シミュレーション全体を実行するメイン関数です。
  * 上記の2つのグラフに対応するデータを計算し、`Plots.jl` を用いて結果をプロットし、`renormalization_plots.png` として保存します。

## 📄 ライセンス

このプロジェクトはMITライセンスの下で公開されています。

