# RenormalizationSim.jl

**場の量子論における繰り込みの可視化シミュレーション**

`RenormalizationSim.jl`は、現代物理学の根幹をなす**繰り込み**（Renormalization）という概念を、単純なスカラー場の理論モデルを通して視覚的に探求するためのもの。このシミュレーションは、実験で観測される物理的な量（粒子の質量など）と、理論を記述するための「裸の」パラメータとの間に存在する、直感に反する関係を明らかにする。

特に、理論が有効とされるエネルギースケール（運動量カットオフ `Λ`）を変化させたとき、観測結果を正しく説明するために、理論の内部パラメータがどのように走る必要があるのかを可視化することに焦点を当てている。

---

## 理論的背景と主要な概念

### 出発点：ラグランジアン
このシミュレーションが基礎とする理論は、自己相互作用を持つ単一のスカラー場 $\phi$ に関するものです。その振る舞いは、以下の**ラグランジアン密度**によって記述される。

$$
\mathcal{L} = \frac{1}{2}(\partial_\mu \phi_0)^2 - \frac{1}{2}m_0^2 \phi_0^2 - \frac{\lambda_0}{4!} \phi_0^4
$$

ここで、
* $\phi_0$: **裸の場 (Bare Field)**。理論の基本的な構成要素ですが、直接観測はできない。
* $m_0$: **裸の質量 (Bare Mass)**。量子補正が入る前の、理論の基本的な質量パラメータ。
* $\lambda_0$: **裸の結合定数 (Bare Coupling Constant)**。場の自己相互作用の強さを決定する。
* 添字 $0$ は、これらの量が「裸の」パラメータ、すなわち繰り込み前の量であることを示している。

### ループ補正と発散の問題
場の量子論（QFT）では、粒子が点Aから点Bへ伝播する確率振幅（**伝播関数**または**プロパゲーター**）を計算する際、あらゆる可能な経路を考慮する必要がある。これには、粒子が途中で仮想粒子を放出し再吸収するような、**ループ**を含む経路も含まれる。

問題は、これらのループ経路からの寄与（ループ補正）を計算すると、ループ内を走る仮想粒子の運動量がすべての値をとりうるため、積分が**無限大に発散**してしまうこと。これは、我々の理論が非常に高いエネルギースケール（プランクスケールなど）では破綻し、何らかの新しい物理法則に取って代わられることを示唆している。

### 解決策としての繰り込み
**繰り込み**は、この無限大の問題を体系的に処理するための強力な枠組み。その核心的なアイデアは以下の通りである。

1.  **正則化 (Regularization)**: まず、発散する積分を数学的に扱うため、意図的に理論を変更し、積分を有限にする手続き（**正則化**）を導入する。このシミュレーションでは**運動量カットオフ ($Λ$)** を採用し、仮想粒子の運動量の上限を $Λ$ に設定する。$Λ$ は、我々の理論が有効だと信じられるエネルギースケールの上限と解釈できる。

2.  **物理量との関係**: 我々が実験で測定するのは、裸のパラメータ ($m_0$, $\lambda_0$) ではなく、すべての量子補正（ループ効果）が含まれた後の**物理的なパラメータ** ($m_{\text{phys}}$, $\lambda_{\text{phys}}$) 。例えば、物理的な質量 $m_{\text{phys}}$ は、裸の質量 $m_0$ にループ補正である**自己エネルギー $Σ$** を加えたものとして表現される。
    
    $$m_{\text{phys}}² = m₀² + Σ(p², m₀², λ₀, Λ)$$
    
3.  **繰り込み条件 (Renormalization Condition)**: 物理的なパラメータを定義するために、具体的な条件を課す。このシミュレーションでは、広く用いられる**オンシェル繰り込みスキーム**を採用している。これは、物理的な粒子が満たすべき自然な条件に基づいている。

4.  **裸のパラメータへの吸収**: 最後に、正則化によって現れた $Λ$ への依存性を、すべて裸のパラメータ ($m_0$, $\lambda_0$) の中に吸収させる。その結果、物理的な観測量は $Λ$ に依存しない有限の値として予言される。この過程で、裸のパラメータ自身は $Λ$ に依存するようになり、$Λ \to ∞$ の極限で発散しますが、それは問題ではない。なぜなら、裸のパラメータは観測不可能な理論上の道具にすぎないから。

---

##  本シミュレーションの物理モデルと前提条件

このシミュレーションでは、上記の理論的枠組みを具体的な計算に落とし込むため、いくつかの重要な前提条件とモデル化を行っている。

* **自己エネルギー (Self-Energy, $Σ$)**: 伝播関数への1ループ補正を計算する。これは粒子の質量を変化させる主要な量子効果。
    
* **オンシェル繰り込み条件**:
    1.  **質量繰り込み**: 物理的質量 $m_{\text{phys}}$ は、「着飾った」伝播関数のポールとして定義される。これにより、$m_0$ と $m_{\text{phys}}$ の関係式 $$m_{\text{phys}}² = m_0^2 + Re[Σ(p²=m_{\text{phys}}²)]$$ が導かれる。
    2.  **波動関数繰り込み**: 相互作用によって場の規格化が変化する効果を補正するため、**波動関数繰り込み定数 $Z$** を導入する。オンシェル条件では、$$p²=m_{\text{phys}}²$$ における伝播関数の留数が1になるように $Z$ を定義する。これにより $$Z⁻¹ = 1 - \frac{d(Re[Σ])}{dp²} |_{p²=m_{\text{phys}}²}$$ という関係式が得られる。
    
* **モデルの単純化（重要な前提）**:
    * このシミュレーションの核心的な単純化として、自己エネルギー $Σ$ の運動量 $p²$ に対する依存性を**無視**している。つまり、$$Σ(p²) ≈ Σ(p²=m_{\text{phys}}²)$$ という近似を用いている。これは、計算を大幅に簡略化し、繰り込みの本質的な側面（$Λ$ に対する裸のパラメータの走り）を明確に抽出するためのもの。
    * ただし、$Z$ 因子を計算する際には、$Σ$ の $p²$ に関する微分 $\frac{dΣ}{dp²}$ が必要になるため、この項は別途モデル化して計算に含めている。

これらの前提のもと、シミュレーションはカットオフ $Λ$ を変化させたときに、上記の繰り込み条件を満たすために裸の質量 $m_0$ と $Z$ 因子がどのように変化しなければならないかを追跡する。

---

##  主な機能

* **繰り込みフローの計算と可視化**: 裸の質量 $m₀²$ と場の強さの繰り込み定数 $Z$ が、エネルギースケール（カットオフ $Λ$）にどう依存するかをグラフで示す。
* **着飾った伝播関数の計算**: 量子補正によって「着飾った」粒子の伝播関数を計算し、量子効果がない自由な場合と比較してプロットする。
* **パラメータ依存性の3D可視化**: 伝播関数が運動量 $p²$ とカットオフスケール $Λ$ の両方にどのように依存するかを3Dサーフェスプロットで示し、繰り込み理論の安定性を視覚的に示す。
* **統合された4連プロット**: 上記のすべてのシミュレーション結果を4つのグラフにまとめ、一つの画像として分かりやすく出力する。

---

## コードの解説

`RenormalizationSim.jl` の中核をなすのは、物理計算を行う関数と、それらを実行してプロットするメイン関数です。

* `calculate_sigma(m_squared_phys, lambda_coupling, cutoff_Lambda)`
    * **目的**: 1ループの自己エネルギー $Σ$ を計算する。
    * **内容**: 物理的質量 $m_{\text{phys}}²$ とカットオフ $Λ$ を使って、$$Σ = \frac{λ}{16π²}  ∫_0^Λ dk \frac{k³}{k² + m_{\text{phys}}²}$$ という積分を数値的に評価する。

* `calculate_sigma_derivative(m_squared_phys, lambda_coupling, cutoff_Lambda)`
    * **目的**: 自己エネルギーの運動量 $p²$ に関する微分 $\frac{dΣ}{dp²}$ を計算する。
    * **内容**: この値は、波動関数繰り込み定数 $Z$ を決定するために必要 ($Z⁻¹ = 1 - \frac{dΣ}{dp²}$)。このシミュレーションでは、この微分項を有限な値としてモデル化している。

* `run_full_simulation()`
    * **目的**: シミュレーション全体を制御し、結果をプロットする。
    * **処理の流れ**:
        1.  物理パラメータ（物理質量 $m_{\text{phys}}$、結合定数 $λ$）を設定する。
        2.  様々なカットオフ $Λ$ の値に対してループを実行し、`calculate_sigma` と `calculate_sigma_derivative` を呼び出して、$m₀²(Λ)$ と $Z(Λ)$ の繰り込みフローを計算する（Graph 1, 2）。
        3.  異なる $Λ$ の値における量子補正を含んだ「着飾った」伝播関数を計算する（Graph 3）。
        4.  運動量 $p²$ とカットオフ $Λ$ を両軸とするグリッド上で伝播関数を計算し、3Dサーフェスプロット用のデータを生成する（Graph 4）。
        5.  `Plots.jl` を用いて4つのグラフを生成・結合し、画像ファイルとして保存する。

---

## プロットの物理的意味

シミュレーションを実行すると、`renormalization_plots_advanced.png` という名前の画像ファイルが生成される。

### Graph 1: Renormalization Flow of Mass (質量の繰り込みフロー)
* **物理的意味**: このグラフは、繰り込みの最も重要な側面、すなわち「無限大の相殺」を視覚化している。
* **見方**:
    * `Self-Energy Σ(Λ)` (青線): 量子補正による質量への寄与。カットオフ $Λ$ を大きくすると、この値は無限大に向かって発散する。
    * `Bare Mass m₀²(Λ)` (オレンジ線): この発散を打ち消すために、理論の根源的なパラメータである裸の質量は、$Λ$ と共に**負の無限大**に向かって走らなければならない。
    * **結論**: 観測される物理質量 $m_{\text{phys}}²$ (黒破線) は、これら二つの発散する量が精妙に相殺し合った結果として、有限の一定値に保たれる。理論の有効範囲 $Λ$ を変えても、物理的な予言は変わらない。

### Graph 2: Renormalization Flow of Z-factor (Z因子の繰り込みフロー)
* **物理的意味**: 相互作用によって、場の「規格化」が変化することを示す。
* **見方**:
    * $Z(Λ)$ (青線): $Z=1$ は相互作用のない自由な場に対応します。量子補正を取り入れると、$Z$ は1からずれていく。これは、相互作用する場と自由な場とでは、1粒子状態の生成確率が異なることを意味する。$Z$ は、この差を補正するためのスケール因子。

### Graph 3: Dressed Propagator (着飾った伝播関数)
* **物理的意味**: 量子補正が、粒子の伝播の仕方にどのような影響を与えるかを示します。
* **見方**:
    * `Free Propagator` (点線): 量子補正がない理想的な状況。$p² = m_{\text{phys}}²$ に鋭いピーク（ポール）を持つ。
    * `Dressed Propagator` (実線/破線): 量子補正を含む、より現実的な伝播関数。ピークの位置は、繰り込みによって物理質量 $m_{\text{phys}}²$ の位置に正しく固定されています。カットオフ $Λ$ の値によって線の形がわずかに異なるが、物理的に重要なピークの位置は不変。これは繰り込みが成功している証拠。

### Graph 4: 3D Propagator Surface (3D伝播関数サーフェス)
* **物理的意味**: 繰り込み理論の堅牢性（robustness）を立体的に示す。
* **見方**:
    * このプロットは、カットオフ $Λ$の値をどのように選んだとしても、伝播関数のピークが、常に $p² ≈ m_{\text{phys}}²$の周りに安定して存在することを示している。$Λ$ は我々の計算を可能にするためのツールであり、物理的な結論は $Λ$ の選び方によらない、という繰り込み理論の中心的な主張が見事に可視化されている。

---

##  担当

小野田:　RenormalizationSim.jl(Graph1~3),runtests.jl \
日野:　RenormalizationSim.jl(Graph4),README.md